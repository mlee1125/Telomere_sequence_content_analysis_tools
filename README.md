# Telomere_sequence_content_analysis_tools
Collection of scripts used in the publication ``Lee, M., et al, 2018, "Telomere sequence content can be used to determine ALT activity in tumours", DOI: 10.1093/nar/gky297.``

Contains scripts used to analyse telomere sequence content from NGS data and a random forest classifier that is able to predict ALT-status from telomere sequence content.

## Telomere Maintenance Mechanism classifer (WGS_telomere_ALT_classifier/)
R project that contrains scripts used to create and run the ALT classifier used in the publication titled "Telomere sequence content can be used to determine ALT activity in tumours", DOI: 10.1093/nar/gky297.

## Scripts for telomere controls (telo_ctrl/)
### sort_telo_ctrls.pl
Usage: perl sort_telo_ctrls.pl <input.fastq>

Description: Sorts reads into 4 files, (1) reads that are from the G-rich telomere strand, (2) reads that are from the C-rich telomere strand, (3) reads that contain a mix of both G- and C-rich telomere repeats, and (4) any reads remaining reads that do not fit into the former 3 groups.

Output files: *.G-strands.fastq, *.C-strands.fastq, *.mixed-strands.fastq, *.others.fastq

### variant_analysis.pl
Usage: perl sort_telo_ctrls.pl <input.fastq>

Description: Analyses the reads from the fastq file, counting the number of each single nucleotide variant in the TTAGGG repeat unit and outputing the counts in csv format. The counts are given in long format, with the counts categorised by base type, base position in TTAGGG repeat unit, position in read, and the total length of the read.

Output files: *.variants_analysis_6.csv

## Scripts for WGS data
### TL_qMotif_tumours.sh
Usage: sh TL_qMotif_tumours.sh

Description: Scans all .xml files in current folder that were generated by qMotif and extracts the scaledInclude counts and scaledUnmapped counts for each sample which can then be summed to determine telomere content. TL_qMotif_tumours_ICGC.sh is designed to be used where matched tumour normal samples contain the same ID with either "Tumour" or "Normal" distinguishing them in the file name.

Output <stdout>: table in csv format containing file/sample id, scaled include reads count, and scaled unmapped reads count.
  
### shredder_count_variants*.pl
Usage: perl shredder_count_variants_ICGC.pl <path to telo_repeat_units_hexamers.txt>
       perl shredder_count_variants_TCGA.pl <path to telo_repeat_units_hexamers.txt>

Description: Analyses all qMotif .bam files in the current directory and counts the number of each type of repeat listed in the <telo_repeat_units_hexamers.txt> file. Script also performs trimming based on quality scores, trimming the read when the average quality score across a 6bp window drops below Phred 30. Counts are given in long format. Output should then be fed into *perform_telomere_analysis.R*.

Output file: telomere_variants_count_trimmed_4TTAGGGu.csv - Sample_ID,Sample_Type,Repeat,Strand,Count

### perform_telomere_analysis.R
Usage: Rscript perform_telomere_analysis.R <input.csv> <output.csv>

Description: Performs telomere sequence content analysis on output of *shredder_count_variants*.pl*. Counts are converted to a proportion of all telomere repeats (including all single nucleotide variant repeats), followed by baseline correction for sequencing error using error calculated from telomere sequencing control (provided in *telo_seq_error.csv* file). Output is given in csv wide format.

Output file: *.csv - normalised counts for each variant repeat in wide format with repeat type as columns and samples for rows.
